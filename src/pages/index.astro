---
import { getCollection } from 'astro:content';
import BaseLayout from '../layouts/BaseLayout.astro';
import { SITE_DESCRIPTION } from '../consts';

const posts = (await getCollection('posts')).sort((a, b) => {
  const pinnedDelta = Number(Boolean(b.data.pinned)) - Number(Boolean(a.data.pinned));
  if (pinnedDelta !== 0) return pinnedDelta;
  return b.data.pubDate.valueOf() - a.data.pubDate.valueOf();
});

const formatDate = (date) =>
  new Intl.DateTimeFormat('zh-CN', {
    year: 'numeric',
    month: '2-digit',
    day: '2-digit',
  }).format(date);
---

<BaseLayout title="文章" description={SITE_DESCRIPTION}>
  <section class="mx-auto max-w-[720px] px-6 pb-16">
    <div class="mb-10">
      <h1 class="text-2xl font-semibold tracking-tight">一些思考</h1>
      <p class="mt-3 text-sm leading-7 text-zinc-500 dark:text-zinc-400">
        记录投资理财、编程技术与生活方式相关的见解与经验。
      </p>
    </div>
    <div class="space-y-8">
      {posts.map((post) => (
        <article class="group">
          <a href={`/posts/${post.slug}/`} class="post-link block">
            <div class="text-xs text-zinc-400 dark:text-zinc-500">
              {formatDate(post.data.pubDate)}
            </div>
            <h2 class="post-title mt-2 text-lg font-medium text-zinc-900 transition-colors group-hover:text-zinc-700 dark:text-zinc-100 dark:group-hover:text-zinc-200">
              {post.data.title}
            </h2>
            <p class="mt-2 text-sm leading-7 text-zinc-500 dark:text-zinc-400">
              {post.data.description}
            </p>
          </a>
        </article>
      ))}
    </div>
  </section>
</BaseLayout>
